---
name: cf-mysql
version: 18
installer_version: 1.0.0
stemcell:
  name:    bosh-vsphere-esxi-ubuntu
  file:    bosh-stemcell-1116-vsphere-esxi-ubuntu.tgz
  version: '1116'
  md5:     11b51900d9fcf92b36e249c475014ec3
releases:
  - name:    cf-mysql
    file:    cf-mysql-0.65-dev.tgz
    version: 0.65-dev
    md5:     252ef535a42bbf06a450641c52a82e18
label: Pivotal CF MySQL Developer
description: A multi-tenant MySQL service for application development and testing. 
image: iVBORw0KGgoAAAANSUhEUgAAALQAAAAoCAYAAABXadAKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MzMzQThENjI1NjUxMUUzQjJFN0UyNkUyM0YzMTQyOCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3MzMzQThENzI1NjUxMUUzQjJFN0UyNkUyM0YzMTQyOCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjczMzNBOEQ0MjU2NTExRTNCMkU3RTI2RTIzRjMxNDI4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjczMzNBOEQ1MjU2NTExRTNCMkU3RTI2RTIzRjMxNDI4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+DbntHgAAA5xJREFUeNrsnE9uozAUxp1RL8AVyGb26RGc7eyYIxDNCcgRkhOMwhGG3WzDEcq+m3KEcoQMkT4rTx7/IWmahvB9kqUS88BCPz9/fqDODoeDoqhH0Tc+AopAUxSBpigCTVEEmiLQFEWgKYpAUxSBpigCTU1QT2Ma7Pfff+9lKFr83fStGxCT9G1xQdzd6PXXD2boK6vo2/Hjk5czz987fssisceYd4AoY9/Rtxfn/LEgl0rR74tbBMZwwD2pB7cciwgIRrnjty2y4yaSgTXONVl0g3b87blvs74t+7bGWArP/d/QvxJxzyLuxTNOaiJA14AsBoFGdqwcfWv0+bLfDtBvRZYtEGcmhBnL8XgOYO37H69Tor8UcY2YGCXOy4jjdDN0OQCADOA0nklRAdLEkVVTwCttg4nzqfVMilUgpkN/bMWgJgB0EsjSCYAuxbErSysLpATHlQfedOD4XJMiJLNi0HpMDOhUZMMmsBHLAGclPLcro24BkbY899pjc3aBe9oev4tkdNf1NZGcJtDSdqQeoEsVL4uVALvAdcymr3Wcu8T19tjoFYGMnXqsTkiNZyWhJmA5lMi+mQMmPTA7dsjGGqC2wqa4gDPViQ7wvyHuWpn12kAXoi0cm9bCaj4bl51htwj0heoAX+7wr62nuuGbGLXwvF3knqY6MVen0tv+SlWKa79okRvjDONMLBvWiGaqR4nnmRLoG2Tp1MqQ2RkwK6t6cU6c8eBzwLCz+s7N2otPgMb4+BqTr7Q2wY3ory0rJ8fVjAWIsQNdA4LMWhrLG68UW2Q1LUBRZ1QtNOKbGyQAPeCc7IMJgkB/QKVYJjWguPXy2Hk2m/lAX7yJ+PdrqrVgLawNbodzUmbo26jxbA5ztHJAheSS6kooPlf/l+mMv95FoN6p06vxz1ZijaXC6mJXdmrAnqnhpce70NPIYHZVL8wGcAOoqgCUl2buDNcvcf9G+OQc/SvHRFsJYGWs+RbFVBZWAXD0gI3xUJh36vQ6P2Y7TNVnTaC/xksbr9dFMvqltkauAvaE+umZSAbijXK/2j6ObRmZaDoAdR0B2lRglJjslWV15PNaWmNL1cg+cZ2N6V+B3cn30KnlN4dOGPk9tKn3mhVnO4alfQzfQz9Khr6l2guti+2xTcWhQBYdDdjcFFIhq7SEh04BdsrHQqDHLvPNdMxPU4/koSmKGZoi0BRFoCmKQFMUgaYoAk0RaIoi0BT1lfonwAAgYQRSborfygAAAABJRU5ErkJggg==
rank: 1

job_types:
  # mysql server must come before the broker, or broker will fail to start as it can't find the database server
  - name: mysql
    label: mysql
    resource_label: MySQL Node
    description: MySQL Server Node
    template: mysql

    resource_definitions:
      - name: ram
        type: integer
        label: RAM
        configurable: true
        default: 8192

      - name: ephemeral_disk
        type: integer
        label: Ephemeral Disk
        configurable: true
        default: 30000

      - name: persistent_disk
        type: integer
        label: Persistent Disk
        configurable: true
        default: 100000

      - name: cpu
        type: integer
        label: CPU
        configurable: true
        default: 2

    static_ip: 1
    dynamic_ip: 0

    instance_definitions:
      - name: instances
        type: integer
        label: Instances
        configurable: false
        default: 1

    property_definitions:
      - name: vm_credentials
        type: salted_credentials
        label: VM credentials
        default:
          identity: vcap

      - name: mysql_admin_password
        type: simple_credentials
        label: MySQL root password

    manifest: |
      admin_password: (( mysql_admin_password.password ))
      max_connections: 1500
      max_user_connections: 40
      innodb_buffer_pool_size: 2147483648

  - name: cf-mysql-broker
    label: MySQL Broker
    resource_label: MySQL Broker
    description: Implements the v2 CF Service Broker API. Provides a catalog of services and plans that cloud controller fetches, and acts on the MySQL node based on provisioning calls received from cloud controller.
    template: cf-mysql-broker

    resource_definitions:
      - name: ram
        type: integer
        label: RAM
        configurable: true
        default: 1024

      - name: ephemeral_disk
        type: integer
        label: Ephemeral Disk
        configurable: true
        default: 10000

      - name: persistent_disk
        type: integer
        label: Persistent Disk
        configurable: false
        default: 0

      - name: cpu
        type: integer
        label: CPU
        configurable: true
        default: 1

    static_ip: 1
    dynamic_ip: 0

    instance_definitions:
      - name: instances
        type: integer
        label: Instances
        configurable: false
        default: 1

    property_definitions:
      - name: vm_credentials
        type: salted_credentials
        label: VM credentials
        default:
          identity: vcap

      - name: broker_auth_password
        type: simple_credentials
        label: Basic Auth Password

    manifest: |
      auth_password: (( broker_auth_password.password ))
      mysql_node:
        host: (( .mysql.first_ip ))
        admin_password: (( .mysql.mysql_admin_password.password ))
      services:
      - id: cf-mysql-1
        name: cf-mysql
        description: A multi-tenant MySQL service for application development and testing.
        bindable: true
        max_db_per_node: 500
        plans:
        - id: cf-mysql-plan-1
          name: 100mb
          description: Shared MySQL Server, 100mb persistent disk, 40 max concurrent connections per user
          max_storage_mb: 100

  - name: compilation
    label: Compilation
    resource_label: Compilation
    description: compilation-description

    resource_definitions:
      - name: ram
        type: integer
        label: RAM
        configurable: true
        default: 1_024

      - name: ephemeral_disk
        type: integer
        label: Ephemeral Disk
        configurable: true
        default: 8_192

      - name: persistent_disk
        type: integer
        label: Persistent Disk
        configurable: false
        default: 0

      - name: cpu
        type: integer
        label: CPU
        configurable: true
        default: 1

    static_ip: 1
    dynamic_ip: 0

    instance_definitions:
      - name: instances
        type: integer
        label: Instances
        default: 1
